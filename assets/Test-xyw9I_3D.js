import{r as d,a as u,b as p,d as t,e as y,f as w,g as k,t as b,F as C,j as F,n as g,u as q}from"./index-CKOF-s42.js";const S={class:"background-out"},O={class:"background-in"},A={class:"head-setting mb-16"},D={class:"flex flex-col flex-grow"},X={key:0,class:"flex flex-col flex-grow"},j={class:"brown-box text-white px-10 h-50 select-none"},I={class:"text-2xl font-bold mb-4"},N={class:"grid grid-cols-2 gap-4 my-5 flex-grow h-50"},T=["onClick"],Y=["disabled"],B={key:1,class:"flex flex-col flex-grow justify-between mt-25"},M={class:"text-center my-auto"},U={class:"text-3xl font-semibold"},$=["disabled"],R={__name:"Test",setup(J){const x=q(),r=d(0),a=d(0),o=d(null),f=d([{question:"강관비계 작업 시 떨어짐 사고는 불가피하다. 안전대는 실질적으로 아무 필요 없다.",options:["O","X"],correct:1},{question:"기계 운전원에 의한 부딪힘 재해는 지게차 운전자의 100% 과실이다.",options:["O","X"],correct:1},{question:"작업 경력이 많은 사람이라고해서 재해발생이 적은것은 아니다.",options:["O","X"],correct:0},{question:"제조업 종사자도 떨어짐 재해를 겪을 수 있다",options:["O","X"],correct:0},{question:"가장 사고가 많이 발생하는 연령대는?",options:["20대","30대","40대","50대"],correct:3},{question:"재해는 주로 근무일수가 많은 평일에 발생한다.",options:["O","X"],correct:1},{question:"보호구가 아닌 것은?",options:["안전모","안전화","장갑","작업복"],correct:3},{question:"작업장 내 정해진 통로 이름은?",options:["고속도로","안전통로","작업통로","가설통로"],correct:1},{question:"날씨가 더운 날 안전관리자의 허가 아래 맥주 한 캔(도수 최대 6%)까지는 허용 범위이다",options:["O","X"],correct:1},{question:"현장 경력이 많은 작업자의 판단 아래 더 효율적인 작업 순서로 변경하는 것이 안전하다",options:["O","X"],correct:1}]),v=s=>{o.value=s},h=()=>{o.value!==null&&o.value===f.value[r.value].correct&&(a.value+=10),r.value++,o.value=null},i=d(!1);function _(){const s=new Date,e=String(s.getFullYear()),c=String(s.getMonth()+1).padStart(2,"0"),n=String(s.getDate()).padStart(2,"0");return`${e}-${c}-${n}`}const m=async()=>{if(i.value)return;i.value=!0;const s=a.value>=80?"pass":"nonepass",e=s==="pass"?{test_status:s,pass_date:_()}:{test_status:s};try{if(!(await fetch("http://localhost:8080/api/user/test",{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify(e)})).ok){alert("시험 결과 저장에 실패했습니다. 잠시 후 다시 시도해주세요.");return}const n=sessionStorage.getItem("loggedInUser");if(n){const l=JSON.parse(n);l.test=s,sessionStorage.setItem("loggedInUser",JSON.stringify(l))}x.push("/safe")}catch{alert("네트워크 오류가 발생했습니다. 잠시 후 다시 시도해주세요.")}finally{i.value=!1}};return(s,e)=>{const c=k("router-link");return p(),u("div",S,[t("div",O,[t("header",A,[y(c,{to:"/safe",class:"heed-text"},{default:w(()=>[...e[0]||(e[0]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2.5",stroke:"#78711D",class:"w-6 h-6"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 19.5 8.25 12l7.5-7.5"})],-1)])]),_:1}),e[1]||(e[1]=t("h1",{class:"text-3xl font-bold text-[#78711D]"},"안전 시험",-1)),e[2]||(e[2]=t("p",null,null,-1))]),t("main",D,[r.value<f.value.length?(p(),u("div",X,[t("div",j,[t("h2",I,b(f.value[r.value].question),1)]),t("div",N,[(p(!0),u(C,null,F(f.value[r.value].options,(n,l)=>(p(),u("button",{key:l,onClick:E=>v(l),class:g(["py-5 border rounded-md cursor-pointer",o.value===l?"bg-black text-[#3A9CFF] border-[#3A9CFF]":"bg-gray-100 border-gray-300 text-black hover:bg-gray-200"])},b(n),11,T))),128))]),t("button",{onClick:h,disabled:o.value===null,class:"w-full px-5 py-3 bg-black text-[#3A9CFF] rounded-md cursor-pointer border border-[#3A9CFF] disabled:bg-gray-400 disabled:text-white disabled:cursor-not-allowed disabled:border-none mt-auto"},"다음 문제",8,Y)])):(p(),u("div",B,[t("div",M,[e[3]||(e[3]=t("h2",{class:"text-4xl font-bold mb-4"},"시험 완료!",-1)),t("p",U,"최종 점수 : "+b(a.value)+"점",1),t("p",{class:g(["text-5xl font-extrabold mt-5",a.value>=80?"text-blue-500":"text-red-500"])},b(a.value>=80?"합격":"불합격"),3)]),t("button",{onClick:m,disabled:i.value,class:"flex justify-center items-center text-lg w-full mt-35 p-3 border bg-[#FFEC17] font-bold rounded-2xl cursor-pointer disabled:opacity-60 disabled:cursor-not-allowed"},b(i.value?"저장 중...":"홈으로"),9,$)]))])])])}}};export{R as default};
