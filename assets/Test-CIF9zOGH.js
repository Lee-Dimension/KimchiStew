import{f as u,a as p,o as x,b as e,d as S,w as O,r as C,t as g,F,e as q,n as _,k as I}from"./index-B0wxRxvP.js";const T={class:"background-out"},U={class:"background-in md:max-w-2xl lg:max-w-3xl"},N={class:"head-setting mb-16 md:mb-20"},A={class:"flex flex-col flex-grow"},D={key:0,class:"flex flex-col flex-grow"},X={class:"brown-box text-white px-10 md:px-12 lg:px-14 h-50 md:min-h-[200px] select-none"},J={class:"text-2xl md:text-3xl font-bold mb-4"},j={class:"grid grid-cols-2 gap-4 md:gap-6 my-5 flex-grow h-50"},Y=["onClick"],B=["disabled"],M={key:1,class:"flex flex-col flex-grow justify-between mt-25"},$={class:"text-center my-auto"},E={class:"text-3xl md:text-4xl font-semibold"},Q=["disabled"],z={__name:"Test",setup(R){const b=I(),a=u(0),i=u(0),r=u(null),m=u([{question:"강관비계 작업 시 떨어짐 사고는 불가피하다. 안전대는 실질적으로 아무 필요 없다.",options:["O","X"],correct:1},{question:"기계 운전원에 의한 부딪힘 재해는 지게차 운전자의 100% 과실이다.",options:["O","X"],correct:1},{question:"작업 경력이 많은 사람이라고해서 재해발생이 적은것은 아니다.",options:["O","X"],correct:0},{question:"제조업 종사자도 떨어짐 재해를 겪을 수 있다",options:["O","X"],correct:0},{question:"가장 사고가 많이 발생하는 연령대는?",options:["20대","30대","40대","50대"],correct:3},{question:"재해는 주로 근무일수가 많은 평일에 발생한다.",options:["O","X"],correct:1},{question:"보호구가 아닌 것은?",options:["안전모","안전화","장갑","작업복"],correct:3},{question:"작업장 내 정해진 통로 이름은?",options:["고속도로","안전통로","작업통로","가설통로"],correct:1},{question:"날씨가 더운 날 안전관리자의 허가 아래 맥주 한 캔(도수 최대 6%)까지는 허용 범위이다",options:["O","X"],correct:1},{question:"현장 경력이 많은 작업자의 판단 아래 더 효율적인 작업 순서로 변경하는 것이 안전하다",options:["O","X"],correct:1}]),y=t=>{r.value=t},w=()=>{r.value!==null&&r.value===m.value[a.value].correct&&(i.value+=10),a.value++,r.value=null},d=u(!1);function f(){const t=new Date,o=String(t.getFullYear()),l=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return`${o}-${l}-${s}`}const k=async()=>{if(d.value)return;d.value=!0;const t=i.value>=80?"pass":"nonepass",o=t==="pass"?{test_status:t,pass_date:f()}:{test_status:t};try{const l=sessionStorage.getItem("loggedInUser"),s=l?JSON.parse(l):null;if(!!(s?.isTester||s?.name==="테스터")){const v=f(),c={...s||{},test:t};t==="pass"&&(c.pass_date=v),sessionStorage.setItem("loggedInUser",JSON.stringify(c)),b.push("/education");return}if(!(await fetch("http://localhost:8080/api/user/test",{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify(o)})).ok){alert("시험 결과 저장에 실패했습니다. 잠시 후 다시 시도해주세요.");return}s&&(s.test=t,t==="pass"&&(s.pass_date=f()),sessionStorage.setItem("loggedInUser",JSON.stringify(s))),b.push("/education")}catch{const s=sessionStorage.getItem("loggedInUser"),n=s?JSON.parse(s):null;if(!!(n?.isTester||n?.name==="테스터")){const v=f(),c={...n||{},test:t};t==="pass"&&(c.pass_date=v),sessionStorage.setItem("loggedInUser",JSON.stringify(c)),b.push("/education")}else alert("네트워크 오류가 발생했습니다. 잠시 후 다시 시도해주세요.")}finally{d.value=!1}};return(t,o)=>{const l=C("router-link");return x(),p("div",T,[e("div",U,[e("header",N,[S(l,{to:"/education",class:"heed-text"},{default:O(()=>[...o[0]||(o[0]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2.5",stroke:"#78711D",class:"w-6 h-6 md:w-8 md:h-8"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 19.5 8.25 12l7.5-7.5"})],-1)])]),_:1}),o[1]||(o[1]=e("h1",{class:"text-3xl md:text-4xl font-bold text-[#78711D]"},"안전 시험",-1)),o[2]||(o[2]=e("p",null,null,-1))]),e("main",A,[a.value<m.value.length?(x(),p("div",D,[e("div",X,[e("h2",J,g(m.value[a.value].question),1)]),e("div",j,[(x(!0),p(F,null,q(m.value[a.value].options,(s,n)=>(x(),p("button",{key:n,onClick:h=>y(n),class:_(["py-5 md:py-6 border rounded-md cursor-pointer md:text-lg",r.value===n?"bg-black text-[#3A9CFF] border-[#3A9CFF]":"bg-gray-100 border-gray-300 text-black hover:bg-gray-200"])},g(s),11,Y))),128))]),e("button",{onClick:w,disabled:r.value===null,class:"w-full px-5 md:px-6 py-3 md:py-4 bg-black text-[#3A9CFF] rounded-md cursor-pointer border border-[#3A9CFF] disabled:bg-gray-400 disabled:text-white disabled:cursor-not-allowed disabled:border-none mt-auto md:text-lg"}," 다음 문제 ",8,B)])):(x(),p("div",M,[e("div",$,[o[3]||(o[3]=e("h2",{class:"text-4xl md:text-5xl font-bold mb-4"},"시험 완료!",-1)),e("p",E," 최종 점수 : "+g(i.value)+"점 ",1),e("p",{class:_(["text-5xl md:text-6xl font-extrabold mt-5",i.value>=80?"text-blue-500":"text-red-500"])},g(i.value>=80?"합격":"불합격"),3)]),e("button",{onClick:k,disabled:d.value,class:"flex justify-center items-center text-lg md:text-xl w-full mt-35 p-3 md:p-4 border bg-[#FFEC17] font-bold rounded-2xl cursor-pointer disabled:opacity-60 disabled:cursor-not-allowed"},g(d.value?"저장 중...":"홈으로"),9,Q)]))])])])}}};export{z as default};
